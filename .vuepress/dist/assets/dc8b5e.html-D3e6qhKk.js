import{_ as n,c as a,e,o as i}from"./app-DVyU65El.js";const l={};function c(d,s){return i(),a("div",null,s[0]||(s[0]=[e(`<p>之前的自动部署有一些python脚本需要手动执行，这一次将他们也交给GitHub Action来做，进一步简化博客部署流程。</p><p>其中发现当没有新的文章时，不能触发master分支的推送，因此在<code>autoFrontmatter.py</code>中添加了一个<code>changeFlag.txt</code>记录当前时间来对每一次部署进行标记。</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">name: Deploy</span>
<span class="line"></span>
<span class="line"># 触发条件：在 push 到 master 分支后</span>
<span class="line">on:</span>
<span class="line">  push:</span>
<span class="line">    branches:</span>
<span class="line">      - master</span>
<span class="line"></span>
<span class="line"># 任务</span>
<span class="line">jobs:</span>
<span class="line">  build-and-deploy:</span>
<span class="line">    runs-on: ubuntu-latest</span>
<span class="line">    steps:</span>
<span class="line">      - name: Checkout</span>
<span class="line">        uses: actions/checkout@v2</span>
<span class="line">        with:</span>
<span class="line">          persist-credentials: false</span>
<span class="line"></span>
<span class="line">      - name: Set up Python 3.8</span>
<span class="line">        uses: actions/setup-python@v1</span>
<span class="line">        with:</span>
<span class="line">          python-version: 3.8</span>
<span class="line"></span>
<span class="line">      - name: Update Frontmatter</span>
<span class="line">        run: python utils/autoFrontmatter.py</span>
<span class="line"></span>
<span class="line">      - name: Update Sidebar</span>
<span class="line">        run: python utils/autoSidebar.py</span>
<span class="line"></span>
<span class="line">      - name: Commit</span>
<span class="line">        env:</span>
<span class="line">          GIT_NAME: \${{ secrets.GIT_NAME }}</span>
<span class="line">          GIT_EMAIL: \${{ secrets.GIT_EMAIL }}</span>
<span class="line">        run: |</span>
<span class="line">          git config --local user.name $GIT_NAME</span>
<span class="line">          git config --local user.email $GIT_EMAIL</span>
<span class="line">          git add .</span>
<span class="line">          git commit -m &quot;Github action update at \`date &#39;+%Y-%m-%d %H:%M:%S&#39;\`.&quot;</span>
<span class="line"></span>
<span class="line">      - name: Push</span>
<span class="line">        uses: ad-m/github-push-action@master</span>
<span class="line">        with:</span>
<span class="line">          github_token: \${{ secrets.GITHUB_TOKEN }}</span>
<span class="line">          branch: master</span>
<span class="line"></span>
<span class="line">      - name: Build</span>
<span class="line">        run: npm install &amp;&amp; npm run build</span>
<span class="line"></span>
<span class="line">      - name: Deploy</span>
<span class="line">        uses: JamesIves/github-pages-deploy-action@releases/v3</span>
<span class="line">        with:</span>
<span class="line">          ACCESS_TOKEN: \${{ secrets.ACCESS_TOKEN }}</span>
<span class="line">          BRANCH: gh-pages</span>
<span class="line">          FOLDER: docs/.vuepress/dist</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)]))}const t=n(l,[["render",c],["__file","dc8b5e.html.vue"]]),r=JSON.parse('{"path":"/blog/dc8b5e.html","title":"GitHub Action自动部署博客","lang":"en-US","frontmatter":{"title":"GitHub Action自动部署博客","date":"2022/12/15","permalink":"/blog/dc8b5e.html","categories":["blog"],"tags":["blog"]},"headers":[],"git":{"createdTime":1732191603000,"updatedTime":1732191603000,"contributors":[{"name":"Ghlerrix","email":"Ghlerrix@outlook.com","commits":1}]},"filePathRelative":"blogs/blog/GitHub Action自动部署博客.md"}');export{t as comp,r as data};

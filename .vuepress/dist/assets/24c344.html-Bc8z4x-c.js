import{_ as s,c as a,e as p,o as t}from"./app-DVyU65El.js";const e={};function o(c,n){return t(),a("div",null,n[0]||(n[0]=[p(`<blockquote><p>因为两个主题在文章目录的管理有些许区别,自动生成文章永久链接分为两个版本，一个对应Vdoing主题，一个对应reco。</p></blockquote><p>自动生成文章永久链接，不仅仅会自动生成<code>permalink</code>，还会同时根据所在子目录自动生成<code>categories</code>和<code>tags</code>。 其实<code>Vdoing</code>主题本身是有自动生成<code>frontMatter</code>功能的，但是需要在<code>dev</code>或者<code>build</code>的时候生效，但是我们所有的编译交予gihub的自动工作流程，因此我写了这个脚本在执行<code>deploy</code>的时候生成<code>frontMatter</code>.</p><h2 id="reco版本" tabindex="-1"><a class="header-anchor" href="#reco版本"><span>reco版本</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> contextlib</span>
<span class="line"><span class="token keyword">from</span> fileinput <span class="token keyword">import</span> filename</span>
<span class="line"><span class="token keyword">import</span> os</span>
<span class="line"><span class="token keyword">import</span> re</span>
<span class="line"><span class="token keyword">import</span> random</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"><span class="token keyword">import</span> glob</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 判断一个字符串是否为数字</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">isNumber</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">with</span> contextlib<span class="token punctuation">.</span>suppress<span class="token punctuation">(</span>ValueError<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token builtin">float</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">True</span></span>
<span class="line">    <span class="token keyword">with</span> contextlib<span class="token punctuation">.</span>suppress<span class="token punctuation">(</span>TypeError<span class="token punctuation">,</span> ValueError<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">import</span> unicodedata</span>
<span class="line">        unicodedata<span class="token punctuation">.</span>numeric<span class="token punctuation">(</span>s<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">True</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">False</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 生成一个新的permalink</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">getNewPermalink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1118481</span><span class="token punctuation">,</span> <span class="token number">16777215</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 得到所有的已有的permalink</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">getExistsPermalinks</span><span class="token punctuation">(</span>docsList<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    permalinks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">for</span> doc <span class="token keyword">in</span> docsList<span class="token punctuation">:</span></span>
<span class="line">        _<span class="token punctuation">,</span> filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>doc<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> filename <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&#39;README.md&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">continue</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">&#39;ignore&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">            content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            result <span class="token operator">=</span> re<span class="token punctuation">.</span>finditer<span class="token punctuation">(</span><span class="token string">r&#39;---+&#39;</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span></span>
<span class="line">            positions <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>span<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">]</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token keyword">not</span> positions<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">continue</span></span>
<span class="line">            temp <span class="token operator">=</span> content<span class="token punctuation">[</span>positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span></span>
<span class="line">            <span class="token keyword">if</span> temp <span class="token operator">!=</span> <span class="token string">&#39;title&#39;</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">continue</span></span>
<span class="line"></span>
<span class="line">            frontMatter <span class="token operator">=</span> content<span class="token punctuation">[</span>positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> positions<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line">            permalinkSpan <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r&#39;permalink&#39;</span><span class="token punctuation">,</span> frontMatter<span class="token punctuation">)</span><span class="token punctuation">.</span>span<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            categoriesSpan <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r&#39;categories&#39;</span><span class="token punctuation">,</span> frontMatter<span class="token punctuation">)</span><span class="token punctuation">.</span>span<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            permalink <span class="token operator">=</span> frontMatter<span class="token punctuation">[</span>permalinkSpan<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> categoriesSpan<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">            permalink <span class="token operator">=</span> permalink<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">            permalinks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>permalink<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> permalinks</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 生成新的FrontMatter</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">getFrontMatter</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> ct<span class="token punctuation">,</span> permalink<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    date <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    frontMatter <span class="token operator">=</span> <span class="token string">&#39;---\\\\n&#39;</span> <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f&#39;title: </span><span class="token interpolation"><span class="token punctuation">{</span>title<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;date: </span><span class="token interpolation"><span class="token punctuation">{</span>date<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;permalink: /</span><span class="token interpolation"><span class="token punctuation">{</span>ct<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>permalink<span class="token punctuation">}</span></span><span class="token string">/\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;categories: \\\\n - </span><span class="token interpolation"><span class="token punctuation">{</span>ct<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;tags: \\\\n - </span><span class="token interpolation"><span class="token punctuation">{</span>ct<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string">&#39;---\\\\n\\\\n&#39;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> frontMatter</span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span></span>
<span class="line">    docsPath <span class="token operator">=</span> <span class="token string">r&#39;docs&#39;</span></span>
<span class="line">    docsList <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>docsPath<span class="token punctuation">}</span></span><span class="token string">/**/*.md&#39;</span></span><span class="token punctuation">,</span> recursive<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">    permalinks <span class="token operator">=</span> getExistsPermalinks<span class="token punctuation">(</span>docsList<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> doc <span class="token keyword">in</span> docsList<span class="token punctuation">:</span></span>
<span class="line">        path<span class="token punctuation">,</span> filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>doc<span class="token punctuation">)</span></span>
<span class="line">        name<span class="token punctuation">,</span> _ <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>filename<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> filename <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&#39;README.md&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">continue</span></span>
<span class="line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token string">&#39;r+&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">&#39;ignore&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">            content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            result <span class="token operator">=</span> re<span class="token punctuation">.</span>finditer<span class="token punctuation">(</span><span class="token string">r&#39;---+&#39;</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">if</span> positions <span class="token operator">:=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>span<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">                temp <span class="token operator">=</span> content<span class="token punctuation">[</span>positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">if</span> temp <span class="token operator">==</span> <span class="token string">&#39;title&#39;</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword">continue</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span></span>
<span class="line">            ct <span class="token operator">=</span> path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">            title <span class="token operator">=</span> name</span>
<span class="line">            permalink <span class="token operator">=</span> getNewPermalink<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">while</span> permalink <span class="token keyword">in</span> permalinks<span class="token punctuation">:</span></span>
<span class="line">                permalink <span class="token operator">=</span> getNewPermalink<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            frontMatter <span class="token operator">=</span> getFrontMatter<span class="token punctuation">(</span>title<span class="token punctuation">,</span> ct<span class="token punctuation">,</span> permalink<span class="token punctuation">)</span></span>
<span class="line">            f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>frontMatter <span class="token operator">+</span> content<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;done!&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="vdoing版本" tabindex="-1"><a class="header-anchor" href="#vdoing版本"><span>Vdoing版本</span></a></h2><p>该版本会同时生成<code>author</code>信息，需在代码开头自己设定</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> contextlib</span>
<span class="line"><span class="token keyword">import</span> os</span>
<span class="line"><span class="token keyword">import</span> re</span>
<span class="line"><span class="token keyword">import</span> random</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"><span class="token keyword">import</span> glob</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 作者名及主页链接</span></span>
<span class="line">AUTHOR <span class="token operator">=</span> <span class="token string">&#39;Ghlerrix&#39;</span></span>
<span class="line">LINK <span class="token operator">=</span> <span class="token string">&#39;&lt;https://github.com/Ghlerrix&gt;&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 判断一个字符串是否为数字</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">isNumber</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">with</span> contextlib<span class="token punctuation">.</span>suppress<span class="token punctuation">(</span>ValueError<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token builtin">float</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">True</span></span>
<span class="line">    <span class="token keyword">with</span> contextlib<span class="token punctuation">.</span>suppress<span class="token punctuation">(</span>TypeError<span class="token punctuation">,</span> ValueError<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">import</span> unicodedata</span>
<span class="line">        unicodedata<span class="token punctuation">.</span>numeric<span class="token punctuation">(</span>s<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">True</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">False</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 生成一个新的permalink</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">getNewPermalink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1118481</span><span class="token punctuation">,</span> <span class="token number">16777215</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 得到所有的已有的permalink</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">getExistsPermalinks</span><span class="token punctuation">(</span>docsList<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    permalinks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">for</span> doc <span class="token keyword">in</span> docsList<span class="token punctuation">:</span></span>
<span class="line">        fileName <span class="token operator">=</span> doc<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> doc<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">&#39;_posts&#39;</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token keyword">not</span> isNumber<span class="token punctuation">(</span>fileName<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">or</span> fileName<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;friends&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">continue</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">&#39;ignore&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">            content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            result <span class="token operator">=</span> re<span class="token punctuation">.</span>finditer<span class="token punctuation">(</span><span class="token string">r&#39;---+&#39;</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">            positions <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>span<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">if</span> <span class="token keyword">not</span> positions<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">continue</span></span>
<span class="line"></span>
<span class="line">            temp <span class="token operator">=</span> content<span class="token punctuation">[</span>positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span></span>
<span class="line">            <span class="token keyword">if</span> temp <span class="token operator">!=</span> <span class="token string">&#39;title&#39;</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">continue</span></span>
<span class="line"></span>
<span class="line">            frontMatter <span class="token operator">=</span> content<span class="token punctuation">[</span>positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> positions<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line">            permalinkSpan <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r&#39;permalink&#39;</span><span class="token punctuation">,</span> frontMatter<span class="token punctuation">)</span><span class="token punctuation">.</span>span<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            categoriesSpan <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r&#39;categories&#39;</span><span class="token punctuation">,</span> frontMatter<span class="token punctuation">)</span><span class="token punctuation">.</span>span<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            permalink <span class="token operator">=</span> frontMatter<span class="token punctuation">[</span>permalinkSpan<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> categoriesSpan<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">            permalink <span class="token operator">=</span> permalink<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">            permalinks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>permalink<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> permalinks</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 生成新的FrontMatter</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">getFrontMatter</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> ct<span class="token punctuation">,</span> permalink<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    date <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    frontMatter <span class="token operator">=</span> <span class="token string">&#39;---\\\\n&#39;</span> <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f&#39;title: </span><span class="token interpolation"><span class="token punctuation">{</span>title<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;date: </span><span class="token interpolation"><span class="token punctuation">{</span>date<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;permalink: /pages/</span><span class="token interpolation"><span class="token punctuation">{</span>permalink<span class="token punctuation">}</span></span><span class="token string">/\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;categories: \\\\n - </span><span class="token interpolation"><span class="token punctuation">{</span>ct<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;tags: \\\\n - </span><span class="token interpolation"><span class="token punctuation">{</span>ct<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f&#39;author: \\\\n name: </span><span class="token interpolation"><span class="token punctuation">{</span>AUTHOR<span class="token punctuation">}</span></span><span class="token string">\\\\n link: </span><span class="token interpolation"><span class="token punctuation">{</span>LINK<span class="token punctuation">}</span></span><span class="token string">\\\\n&#39;</span></span></span>
<span class="line">    frontMatter <span class="token operator">+=</span> <span class="token string">&#39;---\\\\n\\\\n&#39;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> frontMatter</span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">    docsPath <span class="token operator">=</span> <span class="token string">r&#39;docs&#39;</span></span>
<span class="line">    docsList <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>docsPath<span class="token punctuation">}</span></span><span class="token string">/**/*.md&#39;</span></span><span class="token punctuation">,</span> recursive<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    permalinks <span class="token operator">=</span> getExistsPermalinks<span class="token punctuation">(</span>docsList<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">for</span> doc <span class="token keyword">in</span> docsList<span class="token punctuation">:</span></span>
<span class="line">        fileName <span class="token operator">=</span> doc<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> doc<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">&#39;_posts&#39;</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token keyword">not</span> isNumber<span class="token punctuation">(</span>fileName<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">or</span> fileName<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;friends&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">continue</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token string">&#39;r+&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">&#39;ignore&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">            content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            result <span class="token operator">=</span> re<span class="token punctuation">.</span>finditer<span class="token punctuation">(</span><span class="token string">r&#39;---+&#39;</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">if</span> positions <span class="token operator">:=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>span<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">                temp <span class="token operator">=</span> content<span class="token punctuation">[</span>positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">if</span> temp <span class="token operator">==</span> <span class="token string">&#39;title&#39;</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword">continue</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">if</span> doc<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">&#39;_posts&#39;</span><span class="token punctuation">:</span></span>
<span class="line">                ct <span class="token operator">=</span> doc<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">                title <span class="token operator">=</span> fileName<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">            <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">                ct <span class="token operator">=</span> doc<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line">                title <span class="token operator">=</span> doc<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">            permalink <span class="token operator">=</span> getNewPermalink<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">while</span> permalink <span class="token keyword">in</span> permalinks<span class="token punctuation">:</span></span>
<span class="line">                permalink <span class="token operator">=</span> getNewPermalink<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            frontMatter <span class="token operator">=</span> getFrontMatter<span class="token punctuation">(</span>title<span class="token punctuation">,</span> ct<span class="token punctuation">,</span> permalink<span class="token punctuation">)</span></span>
<span class="line">            f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>frontMatter <span class="token operator">+</span> content<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;done!&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7)]))}const i=s(e,[["render",o],["__file","24c344.html.vue"]]),u=JSON.parse('{"path":"/pages/24c344.html","title":"自动生成文章永久链接","lang":"en-US","frontmatter":{"title":"自动生成文章永久链接","date":"2022/07/22","permalink":"/pages/24c344.html","categories":["blog"],"tags":["blog"]},"headers":[{"level":2,"title":"reco版本","slug":"reco版本","link":"#reco版本","children":[]},{"level":2,"title":"Vdoing版本","slug":"vdoing版本","link":"#vdoing版本","children":[]}],"git":{"createdTime":1732191603000,"updatedTime":1732191603000,"contributors":[{"name":"Ghlerrix","email":"Ghlerrix@outlook.com","commits":1}]},"filePathRelative":"blogs/blog/自动生成文章永久链接.md"}');export{i as comp,u as data};

import{_ as s,c as l,a as n,e as t,b as a,d as o,o as r,r as c}from"./app-DVyU65El.js";const d={},p={href:"https://blog.csdn.net/qq_38163755/article/details/110957133",target:"_blank",rel:"noopener noreferrer"};function m(u,e){const i=c("ExternalLinkIcon");return r(),l("div",null,[n("ul",null,[e[2]||(e[2]=t(`<li><p><code>one of the variables needed for gradient computation has been modified by an inplace operation</code></p><ul><li><p>详细报错信息</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Traceback (most recent call last):</span>
<span class="line">File &quot;tools/train.py&quot;, line 242, in &lt;module&gt;</span>
<span class="line">    main()</span>
<span class="line">File &quot;tools/train.py&quot;, line 231, in main</span>
<span class="line">    train_detector(</span>
<span class="line">File &quot;/home/lgh/code/mmlab/mmdetection/mmdet/apis/train.py&quot;, line 244, in train_detector</span>
<span class="line">    runner.run(data_loaders, cfg.workflow)</span>
<span class="line">File &quot;/home/lgh/miniconda3/envs/mmlab/lib/python3.8/site-packages/mmcv/runner/epoch_based_runner.py&quot;, line 127, in run</span>
<span class="line">    epoch_runner(data_loaders[i], **kwargs)</span>
<span class="line">File &quot;/home/lgh/miniconda3/envs/mmlab/lib/python3.8/site-packages/mmcv/runner/epoch_based_runner.py&quot;, line 51, in train</span>
<span class="line">    self.call_hook(&#39;after_train_iter&#39;)</span>
<span class="line">File &quot;/home/lgh/miniconda3/envs/mmlab/lib/python3.8/site-packages/mmcv/runner/base_runner.py&quot;, line 309, in call_hook</span>
<span class="line">    getattr(hook, fn_name)(self)</span>
<span class="line">File &quot;/home/lgh/miniconda3/envs/mmlab/lib/python3.8/site-packages/mmcv/runner/hooks/optimizer.py&quot;, line 56, in after_train_iter</span>
<span class="line">    runner.outputs[&#39;loss&#39;].backward()</span>
<span class="line">File &quot;/home/lgh/miniconda3/envs/mmlab/lib/python3.8/site-packages/torch/tensor.py&quot;, line 245, in backward</span>
<span class="line">    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)</span>
<span class="line">File &quot;/home/lgh/miniconda3/envs/mmlab/lib/python3.8/site-packages/torch/autograd/__init__.py&quot;, line 145, in backward</span>
<span class="line">    Variable._execution_engine.run_backward(</span>
<span class="line">RuntimeError: one of the variables needed for gradient computation has been modified by an inplace operation: [torch.cuda.FloatTensor [2, 2048, 25, 25]], which is output 0 of ReluBackward1, is at version 2; expected version 1 instead. Hint: enable anomaly detection to find the operation that failed to compute its gradient, with torch.autograd.set_detect_anomaly(True).</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>问题分析: 所谓inplace操作就是直接修改地址上的值。</p><p>首先是torch中所有加 _ 的函数，x.squeeze*()，x.unsqueeze*()。这些操作直接修改变量，不返回值。</p><p>其次一些函数可以通过设置是否inplace，比如Pytorch中 torch.relu()和torch.sigmoid()等激活函数不是inplace操作，其中ReLU可通过设置inplace=True进行inplace操作。</p><p>以及一些算术操作，x += res是inplace操作，x = x + res不是。以及一些赋值操作。</p><p>如果一些用于backward的值被inplace操作修改了就会报错，所以最好不使用inplace操作，以及将赋值操作放在各种需要计算梯度运算之前，gather要在赋值之后。</p></li></ul></li><li><p>解决方案： 将<code>ReLu</code>的<code>inplace=True</code>移除</p></li>`,2)),n("li",null,[n("p",null,[e[1]||(e[1]=a("参考文章： ")),n("a",p,[e[0]||(e[0]=a("https://blog.csdn.net/qq_38163755/article/details/110957133")),o(i)])])])])])}const b=s(d,[["render",m],["__file","e8a942.html.vue"]]),h=JSON.parse('{"path":"/pages/e8a942.html","title":"mmdetection报错汇总","lang":"en-US","frontmatter":{"title":"mmdetection报错汇总","date":"2022/07/21","permalink":"/pages/e8a942.html","categories":["mmdetection"],"tags":["mmdetection"]},"headers":[],"git":{"createdTime":1732191603000,"updatedTime":1732191603000,"contributors":[{"name":"Ghlerrix","email":"Ghlerrix@outlook.com","commits":1}]},"filePathRelative":"blogs/mmdetection/mmdetection报错汇总.md"}');export{b as comp,h as data};
